:original_name: vpc_faq_0075.html

.. _vpc_faq_0075:

Why Can't I Delete My VPCs and Subnets?
=======================================

If VPCs and subnets are being used by other resources, you need to delete these resources first based on the prompts on the console before deleting the VPCs and subnets. This following provides detailed deletion prompts and corresponding deletion guide.

-  :ref:`Deleting Subnets <vpc_faq_0075__section16966157133218>`
-  :ref:`Deleting VPCs <vpc_faq_0075__table95312065138>`

.. _vpc_faq_0075__section16966157133218:

Deleting Subnets
----------------

You can refer to :ref:`Table 1 <vpc_faq_0075__table4284113316400>` to delete subnets.

.. _vpc_faq_0075__table4284113316400:

.. table:: **Table 1** Deleting subnets

   +-------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Prompts                                                                                         | Cause                                                                      | Solution                                                                                                                                                   |
   +=================================================================================================+============================================================================+============================================================================================================================================================+
   | You do not have permission to perform this operation.                                           | Your account does not have permissions to delete subnets.                  | Contact the account administrator to grant permissions to your account and then delete the subnet.                                                         |
   +-------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Delete custom routes from the associated route table of the subnet and then delete the subnet.  | The route table has custom routes with the following as the next hop type: | Delete the custom routes from the route table and then delete the subnet.                                                                                  |
   |                                                                                                 |                                                                            |                                                                                                                                                            |
   |                                                                                                 | -  Server                                                                  | #. :ref:`Viewing the Route Table Associated with a Subnet <vpc_route01_0015>`                                                                              |
   |                                                                                                 | -  Extension NIC                                                           | #. :ref:`Deleting a Route <vpc_route01_0012>`                                                                                                              |
   |                                                                                                 | -  Virtual IP address                                                      |                                                                                                                                                            |
   |                                                                                                 | -  NAT gateway                                                             |                                                                                                                                                            |
   +-------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Release any virtual IP addresses configured in the subnet and then delete the subnet.           | The subnet has virtual IP addresses configured.                            | Release the virtual IP addresses from the subnet and then delete the subnet.                                                                               |
   |                                                                                                 |                                                                            |                                                                                                                                                            |
   |                                                                                                 |                                                                            | :ref:`Releasing a Virtual IP Address <vpc_vip_0009>`                                                                                                       |
   +-------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Release any private IP addresses configured in the subnet and then delete the subnet.           | The subnet has virtual IP addresses that are not used by any instance.     | On the **IP Addresses** tab, release these private IP addresses that are not required and then delete the subnet.                                          |
   |                                                                                                 |                                                                            |                                                                                                                                                            |
   |                                                                                                 |                                                                            | #. :ref:`Viewing IP Addresses in a Subnet <vpc_vpc_0012>`                                                                                                  |
   |                                                                                                 |                                                                            | #. In the private IP address list, locate the IP address that is not being used and click **Release** in the **Operation** column.                         |
   |                                                                                                 |                                                                            |                                                                                                                                                            |
   |                                                                                                 |                                                                            |    .. important::                                                                                                                                          |
   |                                                                                                 |                                                                            |                                                                                                                                                            |
   |                                                                                                 |                                                                            |       NOTICE:                                                                                                                                              |
   |                                                                                                 |                                                                            |       If you want to release an in-use private IP address, you need to delete the resource that uses the IP address first.                                 |
   +-------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Delete the resource (ECS or load balancer) that is using the subnet and then delete the subnet. | The subnet is being used by an ECS or a load balancer.                     | Delete the ECS or load balancer and then delete the subnet.                                                                                                |
   |                                                                                                 |                                                                            |                                                                                                                                                            |
   |                                                                                                 |                                                                            | :ref:`Viewing and Deleting Resources in a Subnet <vpc_vpc_0011>`                                                                                           |
   +-------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Delete the load balancer that is using the subnet and then delete the subnet.                   | The subnet is being used by a load balancer.                               | Delete the load balancer and then delete the subnet.                                                                                                       |
   |                                                                                                 |                                                                            |                                                                                                                                                            |
   |                                                                                                 |                                                                            | :ref:`Viewing and Deleting Resources in a Subnet <vpc_vpc_0011>`                                                                                           |
   +-------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Delete the NAT gateway that is using the subnet and then delete the subnet.                     | The subnet is being used by a NAT gateway.                                 | Delete the NAT gateway and then delete the subnet.                                                                                                         |
   |                                                                                                 |                                                                            |                                                                                                                                                            |
   |                                                                                                 |                                                                            | :ref:`Viewing and Deleting Resources in a Subnet <vpc_vpc_0011>`                                                                                           |
   +-------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Delete the resource that is using the subnet and then delete the subnet.                        | The subnet is being used by cloud resources.                               | On the **IP Addresses** tab, view the usage of the IP address, find the resource that is using the IP address, delete the resource, and delete the subnet. |
   |                                                                                                 |                                                                            |                                                                                                                                                            |
   |                                                                                                 |                                                                            | #. :ref:`Viewing IP Addresses in a Subnet <vpc_vpc_0012>`                                                                                                  |
   |                                                                                                 |                                                                            | #. Locate resource based on the usage of the IP address.                                                                                                   |
   |                                                                                                 |                                                                            | #. Delete the resource and then delete the subnet.                                                                                                         |
   +-------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+

Deleting VPCs
-------------

Before deleting a VPC, ensure that all subnets in the VPC have been deleted. You can refer to :ref:`Table 2 <vpc_faq_0075__table95312065138>` to delete VPCs.

.. _vpc_faq_0075__table95312065138:

.. table:: **Table 2** Deleting VPCs

   +---------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------+
   | Prompts                                                                                                                   | Cause                                                                                                                   | Solution                                                                                                      |
   +===========================================================================================================================+=========================================================================================================================+===============================================================================================================+
   | You do not have permission to perform this operation.                                                                     | Your account does not have permissions to delete VPCs.                                                                  | Contact the account administrator to grant permissions to your account and then delete the VPC.               |
   +---------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------+
   | Delete the VPC endpoint service or the route configured for the service from the VPC route table and then delete the VPC. | The VPC route table has custom routes.                                                                                  | Delete the custom routes and then delete the VPC.                                                             |
   |                                                                                                                           |                                                                                                                         |                                                                                                               |
   |                                                                                                                           |                                                                                                                         | #. In the VPC list, locate the row that contains the VPC and click the number in the **Route Tables** column. |
   |                                                                                                                           |                                                                                                                         |                                                                                                               |
   |                                                                                                                           |                                                                                                                         |    The route table list is displayed.                                                                         |
   |                                                                                                                           |                                                                                                                         |                                                                                                               |
   |                                                                                                                           |                                                                                                                         | #. :ref:`Deleting a Route <vpc_route01_0012>`                                                                 |
   +---------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------+
   |                                                                                                                           | The VPC is being used by a VPC endpoint service.                                                                        | Search for the VPC endpoint service on the VPC endpoint service console and delete it.                        |
   +---------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------+
   | This VPC cannot be deleted because it has associated resources.                                                           | The VPC is being used by the following resources:                                                                       | Click the resource name hyperlink as prompted to delete the resource.                                         |
   |                                                                                                                           |                                                                                                                         |                                                                                                               |
   |                                                                                                                           | -  Subnet                                                                                                               | -  :ref:`Table 1 <vpc_faq_0075__table4284113316400>`                                                          |
   |                                                                                                                           | -  VPC peering connection                                                                                               | -  :ref:`Deleting a VPC Peering Connection <vpc_peering_0003>`                                                |
   |                                                                                                                           | -  Custom route table                                                                                                   | -  :ref:`Deleting a Route Table <vpc_route01_0010>`                                                           |
   +---------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------+
   | Delete the virtual gateway that is using the VPC and then delete the VPC.                                                 | The VPC is being used by a Direct Connect virtual gateway.                                                              | On the Direct Connect console, locate the virtual gateway and delete it.                                      |
   +---------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------+
   | Delete the VPN gateway that is using the VPC and then delete the VPC.                                                     | The VPC is being used by a VPN gateway.                                                                                 | On the VPN console, locate the VPN gateway and delete it.                                                     |
   +---------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------+
   | Delete all custom security groups in this region and then delete this last VPC.                                           | In the current region, this is the last VPC and there are custom security groups.                                       | Delete all custom security groups and then delete the VPC.                                                    |
   |                                                                                                                           |                                                                                                                         |                                                                                                               |
   |                                                                                                                           | .. important::                                                                                                          | :ref:`Deleting a Security Group <vpc_securitygroup_0008>`                                                     |
   |                                                                                                                           |                                                                                                                         |                                                                                                               |
   |                                                                                                                           |    NOTICE:                                                                                                              |                                                                                                               |
   |                                                                                                                           |    You only need to delete the custom security groups. The default security group does not affect the deletion of VPCs. |                                                                                                               |
   +---------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------+
   | Release all EIPs in this region and then delete this last VPC.                                                            | In the current region, this is the last VPC and there are EIPs.                                                         | Release all EIPs in this region and then delete this last VPC.                                                |
   |                                                                                                                           |                                                                                                                         |                                                                                                               |
   |                                                                                                                           |                                                                                                                         | :ref:`Unbinding an EIP from an ECS and Releasing the EIP <vpc_eip_0001>`                                      |
   +---------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------+
